{"version":3,"file":"file-queue.js","sources":["../../src/helpers/file-queue.ts"],"sourcesContent":["import Helper from '@ember/component/helper';\nimport { registerDestructor } from '@ember/destroyable';\nimport { inject as service } from '@ember/service';\nimport type { UploadFile } from '../upload-file';\nimport type FileQueueService from '../services/file-queue';\nimport { DEFAULT_QUEUE } from '../services/file-queue';\nimport { FileQueueArgs, QueueListener } from '../interfaces';\n\n/**\n * `file-queue` helper is one of the core primitives of ember-file-upload.\n *\n * @example\n *\n * using the default queue (no `name` property)\n *\n * ```hbs\n * {{#let (file-queue) as |queue|}}\n *   {{queue.progress}}%\n * {{/let}}\n * ```\n *\n * @example\n *\n * named queue:\n *\n * ```hbs\n * {{#let (file-queue name=\"photos\") as |queue|}}\n *   {{queue.progress}}%\n * {{/let}}\n * ```\n */\nexport default class FileQueueHelper extends Helper implements QueueListener {\n  @service declare fileQueue: FileQueueService;\n\n  declare args: FileQueueArgs;\n\n  compute(_positional: unknown[], args: FileQueueArgs) {\n    this.args = args;\n    const queue = this.fileQueue.findOrCreate(args.name ?? DEFAULT_QUEUE);\n\n    queue.addListener(this);\n\n    registerDestructor(this, () => {\n      queue.removeListener(this);\n    });\n\n    return queue;\n  }\n\n  onFileAdded(file: UploadFile) {\n    this.args.onFileAdded?.(file);\n  }\n\n  onFileRemoved(file: UploadFile) {\n    this.args.onFileRemoved?.(file);\n  }\n\n  onUploadStarted(file: UploadFile) {\n    this.args.onUploadStarted?.(file);\n  }\n\n  onUploadSucceeded(file: UploadFile, response: Response) {\n    this.args.onUploadSucceeded?.(file, response);\n  }\n\n  onUploadFailed(file: UploadFile, response: Response) {\n    this.args.onUploadFailed?.(file, response);\n  }\n}\n"],"names":["FileQueueHelper","_class","Helper","constructor","args","_initializerDefineProperty","_descriptor","compute","_positional","queue","fileQueue","findOrCreate","name","DEFAULT_QUEUE","addListener","registerDestructor","removeListener","onFileAdded","file","onFileRemoved","onUploadStarted","onUploadSucceeded","response","onUploadFailed","_applyDecoratedDescriptor","prototype","service","configurable","enumerable","writable","initializer"],"mappings":";;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACqBA,IAAAA,eAAe,IAAAC,MAAA,GAArB,MAAMD,eAAe,SAASE,MAAM,CAA0B;AAAAC,EAAAA,WAAAA,CAAA,GAAAC,IAAA,EAAA;AAAA,IAAA,KAAA,CAAA,GAAAA,IAAA,CAAA,CAAA;AAAAC,IAAAA,0BAAA,oBAAAC,WAAA,EAAA,IAAA,CAAA,CAAA;AAAA,GAAA;AAK3EC,EAAAA,OAAOA,CAACC,WAAsB,EAAEJ,IAAmB,EAAE;IACnD,IAAI,CAACA,IAAI,GAAGA,IAAI,CAAA;AAChB,IAAA,MAAMK,KAAK,GAAG,IAAI,CAACC,SAAS,CAACC,YAAY,CAACP,IAAI,CAACQ,IAAI,IAAIC,aAAa,CAAC,CAAA;AAErEJ,IAAAA,KAAK,CAACK,WAAW,CAAC,IAAI,CAAC,CAAA;IAEvBC,kBAAkB,CAAC,IAAI,EAAE,MAAM;AAC7BN,MAAAA,KAAK,CAACO,cAAc,CAAC,IAAI,CAAC,CAAA;AAC5B,KAAC,CAAC,CAAA;AAEF,IAAA,OAAOP,KAAK,CAAA;AACd,GAAA;EAEAQ,WAAWA,CAACC,IAAgB,EAAE;AAC5B,IAAA,IAAI,CAACd,IAAI,CAACa,WAAW,GAAGC,IAAI,CAAC,CAAA;AAC/B,GAAA;EAEAC,aAAaA,CAACD,IAAgB,EAAE;AAC9B,IAAA,IAAI,CAACd,IAAI,CAACe,aAAa,GAAGD,IAAI,CAAC,CAAA;AACjC,GAAA;EAEAE,eAAeA,CAACF,IAAgB,EAAE;AAChC,IAAA,IAAI,CAACd,IAAI,CAACgB,eAAe,GAAGF,IAAI,CAAC,CAAA;AACnC,GAAA;AAEAG,EAAAA,iBAAiBA,CAACH,IAAgB,EAAEI,QAAkB,EAAE;IACtD,IAAI,CAAClB,IAAI,CAACiB,iBAAiB,GAAGH,IAAI,EAAEI,QAAQ,CAAC,CAAA;AAC/C,GAAA;AAEAC,EAAAA,cAAcA,CAACL,IAAgB,EAAEI,QAAkB,EAAE;IACnD,IAAI,CAAClB,IAAI,CAACmB,cAAc,GAAGL,IAAI,EAAEI,QAAQ,CAAC,CAAA;AAC5C,GAAA;AACF,CAAC,GAAAhB,WAAA,GAAAkB,yBAAA,CAAAvB,MAAA,CAAAwB,SAAA,EAAA,WAAA,EAAA,CApCEC,MAAO,CAAA,EAAA;EAAAC,YAAA,EAAA,IAAA;EAAAC,UAAA,EAAA,IAAA;EAAAC,QAAA,EAAA,IAAA;EAAAC,WAAA,EAAA,IAAA;AAAA,CAAA,CAAA,GAAA7B,MAAA;;;;"}